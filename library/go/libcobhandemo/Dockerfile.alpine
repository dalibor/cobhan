FROM ghcr.io/jgowdy/alpine-gccgo:latest

ENV ALPINE=1

USER root

# build-base is for CGO
# py3-cffi is for Python tests
RUN apk add build-base py3-cffi

# Output apk files are in /home/build/packages
RUN apk add --allow-untrusted /home/build/packages/*.apk

COPY cobhan /cobhan/

COPY libcobhandemo /libcobhandemo/

WORKDIR /libcobhandemo

RUN /libcobhandemo/.build.sh
