name: Debug

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

env:
  CARGO_TERM_COLOR: always

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: true
      matrix:
        os: [ubuntu-latest, macOS-latest]
    steps:
    - uses: actions/checkout@v2
    - name: Build Buster
      run: ./build-buster.sh
      env:
        SKIP_LINUX_ON_MAC: 1
      working-directory: library
    - name: Build Bullseye
      run: ./build-bullseye.sh
      working-directory: library
      env:
        SKIP_LINUX_ON_MAC: 1
    - name: Build Alpine
      run: ./build-alpine.sh
      working-directory: library
      env:
        SKIP_LINUX_ON_MAC: 1
    - name: Build MacOS
      run: ./build-macos.sh
      working-directory: library
